<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>VoteX — On-chain Voting</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f1220; --panel: #151a2c; --panel-2: #0d1327; --fg: #eef3ff; --muted: #99a2bd;
      --accent: #6ea8fe; --accent-2: #4cc9f0; --good: #2ecc71; --bad: #ff6b6b; --warn: #f8c341;
      --border: #26304a; --card: #0f1630; --shadow: 0 10px 24px rgba(0,0,0,0.35);
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu; background: radial-gradient(1200px 700px at 80% -10%, #1c2150, transparent), linear-gradient(180deg, #0a0d1a, #0b0f1f 40%, #0f1220); color: var(--fg); min-height: 100vh; }
    header { position: sticky; top: 0; z-index: 10; background: rgba(15, 18, 32, 0.7); backdrop-filter: blur(8px); border-bottom: 1px solid var(--border); }
    .wrap { max-width: 1200px; margin: 0 auto; padding: 16px; }
    .row { display: flex; align-items: center; gap: 12px; }
    .space { justify-content: space-between; }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; letter-spacing: 0.3px; }
    .logo { width: 28px; height: 28px; background: conic-gradient(from 180deg, var(--accent), var(--accent-2), #8ec5ff, var(--accent)); border-radius: 8px; box-shadow: inset 0 0 20px rgba(255,255,255,0.25); }
    .chip { font-size: 12px; color: var(--muted); background: #141a32; border: 1px solid var(--border); padding: 6px 10px; border-radius: 999px; }
    .btn { border: 0; cursor: pointer; color: #0a0d1a; background: linear-gradient(100deg, var(--accent), #8ab4ff); padding: 10px 14px; border-radius: 10px; font-weight: 700; box-shadow: var(--shadow); }
    .btn:disabled { opacity: 0.85; cursor: default; }
    .btn.connected { background: #16a34a; color: #fff; }
    .btn.secondary { color: var(--fg); background: #182042; }
    .btn.danger { color: white; background: #e55050; }
    main { max-width: 1200px; margin: 24px auto; padding: 0 16px 80px; display: grid; grid-template-columns: 2fr 1fr; gap: 16px; }
    @media (max-width: 980px) { main { grid-template-columns: 1fr; } }
    .card { background: linear-gradient(180deg, var(--panel), var(--panel-2)); border: 1px solid var(--border); border-radius: 16px; padding: 16px; box-shadow: var(--shadow); }
    h2 { margin: 0 0 8px; font-size: 20px; }
    h3 { margin: 10px 0; }
    .muted { color: var(--muted); }
    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    @media (max-width: 700px) { .grid { grid-template-columns: 1fr; } }
    .candidate { display: grid; grid-template-columns: auto 1fr auto; gap: 10px; align-items: center; padding: 12px; border-radius: 12px; background: #0f1630; border: 1px solid var(--border); }
    .cand-id { width: 36px; height: 36px; display: grid; place-items: center; border-radius: 10px; font-weight: 800; color: #0d1222; background: linear-gradient(135deg, #9ed0ff, #5aa6ff); }
    .bar { height: 9px; background: #10183a; border: 1px solid #223055; border-radius: 999px; overflow: hidden; }
    .bar > span { display: block; height: 100%; width: 0%; background: linear-gradient(90deg, #63d0ff, #79ffbd); transition: width 800ms ease; }
    .feed { list-style: none; margin: 0; padding: 0; display: grid; gap: 8px; }
    .feed li { font-size: 13px; color: var(--muted); background: #0f1630; border: 1px solid var(--border); border-radius: 10px; padding: 8px 10px; }
    .section-head { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
    .pill { font-size: 12px; padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border); color: var(--muted); }
    .pill.good { color: #0ee98b; border-color: #0ee98b44; background: #0b1f17; }
    .pill.bad { color: #ff8f8f; border-color: #ff8f8f55; background: #211214; }
    .pill.warn { color: #ffd466; border-color: #ffd46655; background: #251e0d; }
    .admin-panel .row { gap: 8px; }
    input, select { background: #0f1630; color: var(--fg); border: 1px solid var(--border); border-radius: 10px; padding: 10px 12px; min-width: 0; }
    .help { font-size: 12px; color: var(--muted); }
    .toast { position: fixed; right: 16px; bottom: 16px; background: #0f1630; border: 1px solid var(--border); color: var(--fg); padding: 12px 14px; border-radius: 12px; box-shadow: var(--shadow); min-width: 240px; z-index: 50; }
    .footer-note { text-align: center; color: var(--muted); font-size: 12px; margin-top: 10px; }
    .warn-banner { background: #2c1e12; color: #ffd9a6; border: 1px solid #5a3b18; padding: 8px 12px; border-radius: 10px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
  </style>
</head>
<body>
  <header>
    <div class="wrap row space">
      <div class="brand">
        <div class="logo"></div>
        <div>VoteX</div>
        <span id="statusPill" class="pill">Not connected</span>
      </div>
      <div class="row">
        <span id="networkPill" class="pill">—</span>
        <span id="adminPill" class="pill">User</span>
        <span id="addrPill" class="chip mono">—</span>
        <button id="btnConnect" class="btn">Connect Wallet</button>
      </div>
    </div>
  </header>

  <main>
    <section class="card">
      <div class="section-head">
        <h2>Live Results</h2>
        <div class="row">
          <span class="pill" id="candCountPill">0 candidates</span>
          <span id="activePill" class="pill bad">Voting paused</span>
          <button id="btnRefresh" class="btn secondary">Refresh</button>
        </div>
      </div>

      <div id="results" class="grid"></div>
      <div class="footer-note">Click “Vote” on your preferred candidate. One address = one vote.</div>
    </section>

    <aside>
      <section class="card">
        <div class="section-head">
          <h2>Activity</h2>
          <span class="pill">Live feed</span>
        </div>
        <ul id="feed" class="feed">
          <li>Events will appear here after you connect.</li>
        </ul>
      </section>

      <section class="card admin-panel">
        <div class="section-head">
          <h2>Admin Panel</h2>
          <span class="pill">Owner only</span>
        </div>
        <div class="warn-banner" style="margin-bottom:10px;">
          Note: resetVoting in this contract does not clear hasvoted. After reset, previous voters still cannot vote again. Consider a round-based approach for production.
        </div>
        <div class="row" style="margin-bottom:10px;">
          <input id="newCandName" placeholder="New candidate name"/>
          <button id="btnAddCand" class="btn">Add Candidate</button>
        </div>
        <div class="row" style="margin-bottom:10px;">
          <button id="btnToggle" class="btn secondary">Toggle Voting</button>
          <button id="btnReset" class="btn danger">Reset Voting</button>
        </div>
        <div style="margin-top:10px;">
          <details>
            <summary class="muted">Contract settings</summary>
            <div class="help" style="margin-top:8px;">
              Current address: <span id="contractAddr" class="mono"></span>
              <div class="row" style="margin-top:8px;">
                <input id="addrInput" class="mono" placeholder="0xContractAddress"/>
                <button id="btnSetAddr" class="btn secondary">Set Address</button>
              </div>
              <div class="help">Saved in your browser (localStorage).</div>
            </div>
          </details>
        </div>
      </section>
    </aside>
  </main>

  <div id="toast" class="toast" style="display:none;"></div>

  <!-- Load app -->
  <script type="module" src="/src/main.js"></script>

  <div class="wrap footer-note">
    Built with Vite + ethers.js v6 • Test on Sepolia first
  </div>
</body>
</html>